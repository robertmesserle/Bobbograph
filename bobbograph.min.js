/*! Bobbograph (Alpha) by Robert Messerle  |  https://github.com/robertmesserle/Bobbograph */
/*! This work is licensed under the Creative Commons Attribution 3.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by/3.0/. */

!function(root){var Animator;Animator=function(){function Animator(){}return Animator}();var Canvas;Canvas=function(){function Canvas(){}return Canvas.prototype.scaleX=function(x){return this.options.leftPadding+x},Canvas.prototype.scaleY=function(y){return this.options.usableHeight-y+this.options.topPadding},Canvas.prototype.begin=function(){return this["continue"]=!1,this.context.beginPath()},Canvas.prototype.close=function(){return this.context.closePath(),this["continue"]=!1},Canvas.prototype.line=function(point){var left,top;return left=this.scaleX(point.x),top=this.scaleY(point.y),this["continue"]?this.context.lineTo(left,top):(this.context.moveTo(left,top),this["continue"]=!0)},Canvas.prototype.arc=function(point,radius,angle1,angle2,ccw){var left,top;return left=this.scaleX(point.x),top=this.scaleY(point.y),this.context.arc(left,top,radius,-angle1,-angle2,ccw)},Canvas.prototype.stroke=function(color){return color&&(this.context.strokeStyle=color),this.context.stroke()},Canvas.prototype.fill=function(color){return color&&(this.context.fillStyle=color),this.context.fill()},Canvas}();var Bobbograph;Bobbograph=function(){function Bobbograph(id,data,options){this.options=new Options(options),this.context=this.getContext(id),this.data=new Data(data,this.options),this.options.smoothGraph?new CurvedRender(this.data.pixels,this.context,this.options):new LinearRender(this.data.points,this.context,this.options)}return Bobbograph.prototype.getContext=function(id){var canvas,context,element;return element=document.getElementById(id),canvas=document.createElement("canvas"),canvas.setAttribute("height",this.options.height),canvas.setAttribute("width",this.options.width),element.appendChild(canvas),context=canvas.getContext("2d")},Bobbograph}();var CurvedRender,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};CurvedRender=function(_super){function CurvedRender(pixels,context,options){this.pixels=pixels,this.context=context,this.options=options,this.renderSolid(this.pixels,this.options.lineWidth,this.options.color)}return __extends(CurvedRender,_super),CurvedRender.prototype.renderLine=function(pixels,offset,angleOffset){var index,next,pixel,prev,_i,_len,_results;for(_results=[],index=_i=0,_len=pixels.length;_len>_i;index=++_i)pixel=pixels[index],prev=pixels[index-1],next=pixels[index+1],_results.push(this.line(pixel.offsetPoint(prev,next,offset,angleOffset)));return _results},CurvedRender.prototype.renderCap=function(point,right,offset){var angle;return angle=Math.PI/2,right?this.arc(point,offset,angle,-angle):this.arc(point,offset,-angle,angle)},CurvedRender.prototype.renderSolid=function(pixels,lineWidth,color){var angle,offset;return offset=lineWidth/2,angle=Math.PI/2,this.begin(),this.renderLine(pixels,offset,angle),this.renderCap(pixels[pixels.length-1],!0,offset),this.renderLine(pixels.slice().reverse(),offset,angle),this.renderCap(pixels[0],!1,offset),this.close(),this.fill(color)},CurvedRender}(Canvas);var Data;Data=function(){function Data(data,options){this.options=options,this.data=this.formatData(data),this.stats=new Stats(this.data),this.points=this.getPoints(this.data,this.options,this.stats),this.pixels=this.getPixels(this.points,this.options.usableWidth,this.options.smoothGraph)}return Data.prototype.scalePoint=function(val,min,delta,scale){var percent,scaled,scoped;return scoped=val-min,percent=scoped/delta,scaled=percent*scale},Data.prototype.getPoints=function(data,options,stats){var dx,dy,point,usableHeight,usableWidth,x,xmin,y,ymin,_i,_len,_results;for(usableWidth=options.usableWidth,usableHeight=options.usableHeight,xmin=stats.xmin,ymin=stats.ymin,dx=stats.dx,dy=stats.dy,_results=[],_i=0,_len=data.length;_len>_i;_i++)point=data[_i],x=this.scalePoint(point.x,xmin,dx,usableWidth),y=this.scalePoint(point.y,ymin,dy,usableHeight),_results.push(new Point(x,y));return _results},Data.prototype.sortMethod=function(a,b){return a.x-b.x},Data.prototype.formatData=function(data){var index,points,val,_i,_len,_results;if("number"==typeof data[0]){for(_results=[],index=_i=0,_len=data.length;_len>_i;index=++_i)val=data[index],_results.push(new Point(index,val));return _results}return data[0]instanceof Array?(points=function(){var _j,_len1,_results1;for(_results1=[],index=_j=0,_len1=data.length;_len1>_j;index=++_j)val=data[index],_results1.push(new Point(val[0],val[1]));return _results1}(),points.sort(sortMethod)):data[0]&&null!=data[0].x&&null!=data[0].y?(points=function(){var _j,_len1,_results1;for(_results1=[],index=_j=0,_len1=data.length;_len1>_j;index=++_j)val=data[index],_results1.push(new Point(val.x,val.y));return _results1}(),points.sort(sortMethod)):void 0},Data.prototype.getPixels=function(points,width,curve){var index,lastPoint,method,pixels,point,_i,_j,_len,_ref,_ref1;for(method=curve?Easing.curve:Easing.linear,pixels=new Array(width),_i=0,_len=points.length;_len>_i;_i++){if(point=points[_i],"undefined"!=typeof lastPoint&&null!==lastPoint)for(index=_j=_ref=Math.round(lastPoint.x),_ref1=Math.round(point.x);_ref1>=_ref?_ref1>=_j:_j>=_ref1;index=_ref1>=_ref?++_j:--_j)pixels[index]=new Point(index,method(index-lastPoint.x,lastPoint.y,point.y-lastPoint.y,point.x-lastPoint.x));lastPoint=point}return pixels},Data}();var Easing;Easing=function(){function Easing(){}return Easing.curve=function(t,b,c,d){return(t/=d/2)<1?c/2*Math.pow(t,2)+b:-c/2*((t-1)*(t-3)-1)+b},Easing.linear=function(t,b,c,d){return c*t/d+b},Easing}();var LinearRender,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};LinearRender=function(_super){function LinearRender(points,context,options){this.points=points,this.context=context,this.options=options,this.renderSolid(this.points,this.options.lineWidth,this.options.color)}return __extends(LinearRender,_super),LinearRender.prototype.getSegments=function(points,offset){var index,_i,_ref,_results;for(_results=[],index=_i=1,_ref=points.length-1;_ref>=1?_ref>=_i:_i>=_ref;index=_ref>=1?++_i:--_i)_results.push(new Segment(points[index-1],points[index],offset));return _results},LinearRender.prototype.renderLine=function(points,offset){var index,next,reverse,s1,s2,segment,segments,_i,_j,_len,_len1,_results;for(segments=this.getSegments(points,offset),index=_i=0,_len=segments.length;_len>_i;index=++_i)segment=segments[index],next=segments[index+1],index||this.line(segment.corner1),next?segment.angle>next.angle?(this.line(segment.corner2),this.arc(next.p1,offset,segment.topAngle,next.topAngle)):(s1=new Segment(segment.corner1,segment.corner2,0),s2=new Segment(next.corner1,next.corner2,0),this.line(s1.intersects(s2))):this.arc(segment.p2,offset,segment.topAngle,segment.bottomAngle);for(reverse=segments.slice().reverse(),_results=[],index=_j=0,_len1=reverse.length;_len1>_j;index=++_j)segment=reverse[index],next=reverse[index+1],next?segment.angle>next.angle?(this.line(segment.corner4),_results.push(this.arc(next.p2,offset,segment.bottomAngle,next.bottomAngle))):(s1=new Segment(segment.corner3,segment.corner4,0),s2=new Segment(next.corner3,next.corner4,0),_results.push(this.line(s1.intersects(s2)))):_results.push(this.arc(segment.p1,offset,segment.bottomAngle,segment.topAngle));return _results},LinearRender.prototype.renderSolid=function(points,lineWidth,color){var offset;return offset=lineWidth/2,this.begin(),this.renderLine(points,offset,!0),this.close(),this.fill(color)},LinearRender}(Canvas);var Options;Options=function(){function Options(options){var key,value;null==options&&(options={});for(key in options)value=options[key],this[key]=value;this.calculatePadding()}return Options.prototype.height=300,Options.prototype.width=600,Options.prototype.lineWidth=10,Options.prototype.color="#000",Options.prototype.smoothGraph=!1,Options.prototype.padding=null,Options.prototype.xPadding=null,Options.prototype.yPadding=null,Options.prototype.leftPadding=null,Options.prototype.rightPadding=null,Options.prototype.topPadding=null,Options.prototype.bottomPadding=null,Options.prototype.usableWidth=null,Options.prototype.usableHeight=null,Options.prototype.calculatePadding=function(){return null==this.padding&&(this.padding=this.lineWidth),null==this.xPadding&&(this.xPadding=this.padding),null==this.yPadding&&(this.yPadding=this.padding),null==this.leftPadding&&(this.leftPadding=this.xPadding),null==this.rightPadding&&(this.rightPadding=this.xPadding),null==this.topPadding&&(this.topPadding=this.yPadding),null==this.bottomPadding&&(this.bottomPadding=this.yPadding),this.usableWidth=this.width-this.leftPadding-this.rightPadding,this.usableHeight=this.height-this.topPadding-this.bottomPadding},Options}();var Point;Point=function(){function Point(x,y){this.x=x,this.y=y}return Point.prototype.getAngle=function(point){var p1,p2,_ref;return _ref=point.x>this.x?[this,point]:[point,this],p1=_ref[0],p2=_ref[1],Trig.getAngleFromPoints(p1,p2)},Point.prototype.offsetPoint=function(prev,next,offset,angleOffset){var angle,perp,point;return null==prev&&(prev=this),null==next&&(next=this),angle=Trig.getAngleFromPoints(prev,next),perp=angle+angleOffset,point=Trig.getPointFromAngle(this,perp,offset)},Point}();var Segment;Segment=function(){function Segment(p1,p2,offset){this.p1=p1,this.p2=p2,this.offset=offset,this.angle=this.reduceAngle(Trig.getAngleFromPoints(this.p1,this.p2)),this.slope=(this.p2.y-this.p1.y)/(this.p2.x-this.p1.x),this.yint=this.p1.y-this.slope*this.p1.x,this.topAngle=this.angle+Trig.rad(90),this.bottomAngle=this.angle-Trig.rad(90),this.corner1=Trig.getPointFromAngle(this.p1,this.topAngle,this.offset),this.corner2=Trig.getPointFromAngle(this.p2,this.topAngle,this.offset),this.corner3=Trig.getPointFromAngle(this.p2,this.bottomAngle,this.offset),this.corner4=Trig.getPointFromAngle(this.p1,this.bottomAngle,this.offset)}return Segment.prototype.reduceAngle=function(angle){for(;angle>Math.PI;)angle-=2*Math.PI;return angle},Segment.prototype.intersects=function(segment){var x,y;return x=(segment.yint-this.yint)/(this.slope-segment.slope),y=this.slope*x+this.yint,new Point(x,y)},Segment}();var Stats;Stats=function(){function Stats(data){this.getRangeData(data)}return Stats.prototype.getRangeData=function(data){var point,xarr,yarr;return xarr=function(){var _i,_len,_results;for(_results=[],_i=0,_len=data.length;_len>_i;_i++)point=data[_i],_results.push(point.x);return _results}(),yarr=function(){var _i,_len,_results;for(_results=[],_i=0,_len=data.length;_len>_i;_i++)point=data[_i],_results.push(point.y);return _results}(),this.xmin=Math.min.apply(null,xarr),this.xmax=Math.max.apply(null,xarr),this.ymin=Math.min.apply(null,yarr),this.ymax=Math.max.apply(null,yarr),this.dx=this.xmax-this.xmin,this.dy=this.ymax-this.ymin},Stats}();var Trig;Trig=function(){function Trig(){}return Trig.rad=function(deg){return deg*Math.PI/180},Trig.deg=function(rad){return 180*rad/Math.PI},Trig.getBaseAngleFromPoints=function(dx,dy){var angle;return angle=Math.atan(dy/dx),Math.abs(angle)},Trig.getQuadrant=function(dx,dy){return dy>=0?dx>=0?1:2:0>dx?3:4},Trig.getAngleFromPoints=function(p1,p2){var baseAngle,dx,dy;switch(dx=p2.x-p1.x,dy=p2.y-p1.y,baseAngle=this.getBaseAngleFromPoints(dx,dy),this.getQuadrant(dx,dy)){case 1:return baseAngle;case 2:return Math.PI-baseAngle;case 3:return Math.PI+baseAngle;case 4:return 2*Math.PI-baseAngle}},Trig.getDistanceBetweenPoints=function(p1,p2){var distance,dx,dy;return dx=p2.x-p1.x,dy=p2.y-p1.y,distance=Math.sqrtdx*dx+dy*dy},Trig.getPointFromAngle=function(origin,angle,distance){var x,y;return x=origin.x,y=origin.y,angle===Math.PI?new Point(x-distance,y):angle===Math.PI/2?new Point(x,y+distance):angle===1.5*Math.PI?new Point(x,y-distance):0===angle?new Point(x+distance,y):new Point(Math.cos(angle)*distance+x,Math.sin(angle)*distance+y)},Trig}();var Util;Util=function(){function Util(){}return Util.excanvas="undefined"!=typeof G_vmlCanvasManager,Util.getProperty=function(obj,namespace,notFoundValue){var part,_i,_len,_ref;if(null==obj)return notFoundValue;for(_ref=namespace.split("."),_i=0,_len=_ref.length;_len>_i;_i++)if(part=_ref[_i],obj=obj[part],null==obj)return notFoundValue;return obj},Util.minMax=function(num,min,max){return num>max?max:min>num?min:num},Util}(),"function"==typeof define&&define.amd?define(function(){return Bobbograph}):root.Bobbograph=Bobbograph}(this);