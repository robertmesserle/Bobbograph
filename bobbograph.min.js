/*! Bobbograph (Alpha) by Robert Messerle  |  https://github.com/robertmesserle/Bobbograph */
/*! This work is licensed under the Creative Commons Attribution 3.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by/3.0/. */

!function(root){var Animator;Animator=function(){function Animator(){}return Animator}();var Bobbograph;Bobbograph=function(){function Bobbograph(id,data,options){this.options=new Options(options),this.context=this.getContext(id),this.data=new Data(data,this.options),new Render(this.data.pixels,this.context,this.options)}return Bobbograph.prototype.getContext=function(id){var canvas,context,element;return element=document.getElementById(id),canvas=document.createElement("canvas"),canvas.setAttribute("height",this.options.height),canvas.setAttribute("width",this.options.width),element.appendChild(canvas),context=canvas.getContext("2d")},Bobbograph}();var Data;Data=function(){function Data(data,options){this.options=options,this.data=this.formatData(data),this.stats=this.getStats(this.data),this.points=this.getPoints(this.data,this.options,this.stats),this.pixels=this.getPixels(this.points,this.options.width,this.options.smoothGraph)}return Data.prototype.scalePoint=function(val,min,delta,scale){var percent,scaled,scoped;return scoped=val-min,percent=scoped/delta,scaled=percent*scale},Data.prototype.getPoints=function(data,options,stats){var point,_i,_len,_results;for(_results=[],_i=0,_len=data.length;_len>_i;_i++)point=data[_i],_results.push({x:this.scalePoint(point.x,stats.xmin,stats.dx,options.width),y:this.scalePoint(point.y,stats.ymin,stats.dy,options.height)});return _results},Data.prototype.getStats=function(data){var point,stats,xarr,yarr;return xarr=function(){var _i,_len,_results;for(_results=[],_i=0,_len=data.length;_len>_i;_i++)point=data[_i],_results.push(point.x);return _results}(),yarr=function(){var _i,_len,_results;for(_results=[],_i=0,_len=data.length;_len>_i;_i++)point=data[_i],_results.push(point.y);return _results}(),stats={xmin:Math.min.apply(null,xarr),xmax:Math.max.apply(null,xarr),ymin:Math.min.apply(null,yarr),ymax:Math.max.apply(null,yarr)},stats.dx=stats.xmax-stats.xmin,stats.dy=stats.ymax-stats.ymin,stats},Data.prototype.formatData=function(data){var index,sort,val,_i,_len,_results;if(sort=function(a,b){return a.x-b.x},"number"==typeof data[0]){for(_results=[],index=_i=0,_len=data.length;_len>_i;index=++_i)val=data[index],_results.push({x:index,y:val});return _results}return data[0]instanceof Array?function(){var _j,_len1,_results1;for(_results1=[],index=_j=0,_len1=data.length;_len1>_j;index=++_j)val=data[index],_results1.push({x:val[0],y:val[1]});return _results1}().sort(sort):data[0]&&null!=data[0].x&&null!=data[0].y?data.sort(sort):void 0},Data.prototype.getPixels=function(points,width,curve){var index,lastPoint,method,pixels,point,_i,_j,_len,_ref,_ref1;for(method=curve?Easing.curve:Easing.linear,pixels=new Array(width),_i=0,_len=points.length;_len>_i;_i++){if(point=points[_i],"undefined"!=typeof lastPoint&&null!==lastPoint)for(index=_j=_ref=lastPoint.x,_ref1=point.x;_ref1>=_ref?_ref1>=_j:_j>=_ref1;index=_ref1>=_ref?++_j:--_j)pixels[index]=method(index-lastPoint.x,lastPoint.y,point.y-lastPoint.y,point.x-lastPoint.x);lastPoint=point}return pixels},Data}();var Easing;Easing=function(){function Easing(){}return Easing.curve=function(t,b,c,d){return(t/=d/2)<1?c/2*Math.pow(t,2)+b:-c/2*((t-1)*(t-3)-1)+b},Easing.linear=function(t,b,c,d){return c*t/d+b},Easing}();var Options;Options=function(){function Options(options){var key,value;null==options&&(options={});for(key in options)value=options[key],this[key]=value;this.calculatePadding()}return Options.prototype.height=300,Options.prototype.width=600,Options.prototype.bevel=!1,Options.prototype.bevelIntensity=1,Options.prototype.shineIntensity=.65,Options.prototype.shadowIntensity=.3,Options.prototype.smoothBevel=!1,Options.prototype.lineWidth=5,Options.prototype.color="#000",Options.prototype.shadow=!1,Options.prototype.fill=!1,Options.prototype.verticalFill=!1,Options.prototype.dashed=!1,Options.prototype.dashSize=5,Options.prototype.maxPoints=!1,Options.prototype.peaksAndValleys=!1,Options.prototype.verticalLineFill=!1,Options.prototype.smoothGraph=!1,Options.prototype.smoothingMethod=!1,Options.prototype.normalRange=!1,Options.prototype.animationDuration=0,Options.prototype.easingMethod=!1,Options.prototype.callback=!1,Options.prototype.maxX=!1,Options.prototype.maxY=!1,Options.prototype.minX=!1,Options.prototype.minY=!1,Options.prototype.percent=1,Options.prototype.padding=0,Options.prototype.xPadding=null,Options.prototype.yPadding=null,Options.prototype.leftPadding=null,Options.prototype.rightPadding=null,Options.prototype.topPadding=null,Options.prototype.bottomPadding=null,Options.prototype.usableWidth=600,Options.prototype.usableHeight=300,Options.prototype.calculatePadding=function(){return null==this.xPadding&&(this.xPadding=this.padding),null==this.yPadding&&(this.yPadding=this.padding),null==this.leftPadding&&(this.leftPadding=this.xPadding),null==this.rightPadding&&(this.rightPadding=this.xPadding),null==this.topPadding&&(this.topPadding=this.yPadding),null!=this.bottomPadding?this.bottomPadding:this.bottomPadding=this.yPadding},Options}();var Render;Render=function(){function Render(pixels,context,options){this.pixels=pixels,this.context=context,this.options=options,this.options.dashed?this.renderDashed(this.pixels,this.context,this.options.dashSize):this.renderSolid(this.pixels,this.context)}return Render.prototype.renderDashed=function(pixels,context,size){var dist,index,last,line,_i,_ref,_results;for(last={x:0,y:pixels[0]},context.moveTo(last.x,last.y),line=!0,_results=[],index=_i=1,_ref=pixels.length-1;_ref>=1?_ref>=_i:_i>=_ref;index=_ref>=1?++_i:--_i)dist=Trig.getDistanceBetweenPoints(last.x,last.y,index,pixels[index]),dist>size?(line?(context.lineTo(index,pixels[index]),context.stroke()):(context.beginPath(),context.moveTo(index,pixels[index])),line=!line,_results.push(last={x:index,y:pixels[index]})):_results.push(void 0);return _results},Render.prototype.renderSolid=function(pixels,context){var index,_i,_ref;for(context.moveTo(0,pixels[0]),index=_i=1,_ref=pixels.length-1;_ref>=1?_ref>=_i:_i>=_ref;index=_ref>=1?++_i:--_i)context.lineTo(index,pixels[index]);return context.stroke()},Render}();var Trig;Trig=function(){function Trig(){}return Trig.rad=function(deg){return deg*Math.PI/180},Trig.deg=function(rad){return 180*rad/Math.PI},Trig.getBaseAngleFromPoints=function(dx,dy){var angle;return angle=Math.atan(dy/dx),Math.abs(angle)},Trig.getAngleFromPoints=function(x1,y1,x2,y2){var baseAngle,dx,dy;return dx=x2-x1,dy=y2-y1,baseAngle=this.getBaseAngleFromPoints(dx,dy),dx>0?dy>0?baseAngle:0>dy?2*Math.PI-baseAngle:0:0>dx?dy>0?Math.PI-baseAngle:0>dy?Math.PI+baseAngle:Math.PI:dy>0?Math.PI/2:0>dy?1.5*Math.PI:0},Trig.getDistanceBetweenPoints=function(x1,y1,x2,y2){var distance,dx,dy;return dx=x2-x1,dy=y2-y1,distance=Math.sqrt(dx*dx+dy*dy)},Trig.getPointFromAngle=function(x,y,angle,distance){return angle===Math.PI?{x:x-distance,y:y}:angle===Math.PI/2?{x:x,y:y+distance}:angle===1.5*Math.PI?{x:x,y:y-distance}:0===angle?{x:x+distance,y:y}:{x:Math.cos(angle)*distance+x,y:Math.sin(angle)*distance+y}},Trig}();var Util;Util=function(){function Util(){}return Util.excanvas="undefined"!=typeof G_vmlCanvasManager,Util.getProperty=function(obj,namespace,notFoundValue){var part,_i,_len,_ref;if(null==obj)return notFoundValue;for(_ref=namespace.split("."),_i=0,_len=_ref.length;_len>_i;_i++)if(part=_ref[_i],obj=obj[part],null==obj)return notFoundValue;return obj},Util.minMax=function(num,min,max){return num>max?max:min>num?min:num},Util}(),"function"==typeof define&&define.amd?define(function(){return Bobbograph}):root.Bobbograph=Bobbograph}(this);